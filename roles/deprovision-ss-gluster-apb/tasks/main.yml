##############################################################################
## Deprovision ss-gluster
## This role executes much of the needed functionality to deprovision an
## application using an Ansible Playbook Bundle and delete resources created
## in the sample apb generated by the provision role.
##############################################################################
- name: Delete ss-gluster resources
  oc_obj:
    namespace: "{{ glusterfs_namespace }}"
    kind: "{{ item.kind }}"
    name: "{{ item.name | default(omit) }}"
    selector: "{{ item.selector | default(omit) }}"
    state: absent
  with_items:
  - kind: "all,svc,deploy,secret,sc,pvc,statefulsets"
    selector: "glusterfs"
failed_when: False

##############################################################################
## Deprovision a route
##############################################################################
#- openshift_v1_route:
#    name: ss-gluster
#    namespace: '{{ namespace }}'
#    state: absent

##############################################################################
## Deprovision a storageclass
##############################################################################
#- openshift_v1_storageclass:
#    name: gluster
#    namespace: '{{ namespace }}'
#    state: absent


##############################################################################
## Deprovision a service
##############################################################################
#- k8s_v1_service:
#    name: glusterfs
#    namespace: '{{ namespace }}'
#    state: absent


##############################################################################
## Deprovision a deployment config
## When removing a Deployment Config, OpenShift will automatically clean up
## its associated resources like replication controllers and pods
##############################################################################
#- openshift_v1_deployment_config:
#    name: ss-gluster
#    namespace: '{{ namespace }}'
#    state: absent